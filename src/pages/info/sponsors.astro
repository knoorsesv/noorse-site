---
import type {
  ContentfulPage,
  ContentfulSponsor,
} from '../../data/contentful/types'
import Layout from '../../layouts/Layout.astro'
import { contentfulClient } from '../../lib/contentful'
import { SponsorPage } from '../../react/pages'

const sponsors = (
  await contentfulClient.withoutUnresolvableLinks.getEntries<ContentfulSponsor>(
    {
      content_type: 'sponsor',
    }
  )
).items.map(({ fields }) => ({
  naam: fields.naam,
  websiteUrl: fields.websiteUrl,
  logo: {
    responsiveURL:
      fields.logo?.fields.file?.url.replace('//', 'https://') +
      '?w=300&h=200&fm=jpg&fl=progressive',
  },
}))

const page = (
  await contentfulClient.getEntries<ContentfulPage>({
    'fields.title': 'Sponsors',
    content_type: 'page',
  })
).items[0]?.fields
---

<Layout title="Info - Bestuur" currentURL={Astro.url}>
  <SponsorPage sponsors={sponsors} description={page.body} />
</Layout>
